{
  "permissions": {
    "allow": [
      "Bash(python -c \"\n# -*- coding: utf-8 -*-\nimport requests\nimport hashlib\nimport time\nimport random\nimport json\nimport sys\nsys.stdout.reconfigure\\(encoding=''utf-8''\\)\n\nsession = requests.Session\\(\\)\nSTORE_ID = ''62fa94df8c13af2e242eba16''\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36 \\(KHTML, like Gecko\\) Chrome/120.0.0.0 Safari/537.36'',\n}\n\nsession.get\\(''https://shop.amul.com/en/browse/protein'', headers=headers, timeout=30\\)\nresp = session.get\\(f''https://shop.amul.com/user/info.js?_v={int\\(time.time\\(\\)*1000\\)}'', headers=headers, timeout=30\\)\nsession_data = json.loads\\(resp.text.replace\\(''session = '', ''''\\)\\)\nsession_tid = session_data.get\\(''tid'', ''''\\)\n\ndef generate_tid\\(\\):\n    timestamp = str\\(int\\(time.time\\(\\) * 1000\\)\\)\n    rand = random.randint\\(0, 999\\)\n    hash_input = f''{STORE_ID}:{timestamp}:{rand}:{session_tid}''\n    hash_value = hashlib.sha256\\(hash_input.encode\\(\\)\\).hexdigest\\(\\)\n    return f''{timestamp}:{rand}:{hash_value}''\n\napi_headers = {\n    **headers,\n    ''tid'': generate_tid\\(\\),\n    ''Accept'': ''application/json, text/plain, */*'',\n    ''Origin'': ''https://shop.amul.com'',\n    ''Referer'': ''https://shop.amul.com/en/browse/protein'',\n    ''frontend'': ''1'',\n}\n\n# Set pincode\npref_url = ''https://shop.amul.com/entity/ms.settings/_/setPreferences''\npref_headers = {**api_headers, ''Content-Type'': ''application/json'', ''tid'': generate_tid\\(\\)}\nsession.put\\(pref_url, json={''pincode'': ''400063'', ''substore'': ''mumbai-br''}, headers=pref_headers, timeout=30\\)\n\n# Try different categories\ncategories = [''protein'', ''milk'', ''ghee'', ''organic'', ''beverages'']\nurl = ''https://shop.amul.com/api/1/entity/ms.products''\n\nfor cat in categories:\n    params = {\n        ''fields[name]'': 1,\n        ''fields[inventory_quantity]'': 1,\n        ''filters[0][field]'': ''categories'',\n        ''filters[0][value]'': cat,\n        ''filters[0][operator]'': ''in'',\n        ''substore'': ''mumbai-br'',\n        ''limit'': 10\n    }\n    api_headers[''tid''] = generate_tid\\(\\)\n    resp = session.get\\(url, params=params, headers=api_headers, timeout=30\\)\n    data = resp.json\\(\\)\n    count = len\\(data.get\\(''data'', []\\)\\)\n    total = data.get\\(''paging'', {}\\).get\\(''total'', 0\\)\n    print\\(f''{cat}: {count} items \\(total: {total}\\)''\\)\n\")",
      "Bash(python -c \"\n# -*- coding: utf-8 -*-\nimport requests\nimport hashlib\nimport time\nimport random\nimport json\nimport sys\nsys.stdout.reconfigure\\(encoding=''utf-8''\\)\n\nsession = requests.Session\\(\\)\nSTORE_ID = ''62fa94df8c13af2e242eba16''\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36 \\(KHTML, like Gecko\\) Chrome/120.0.0.0 Safari/537.36'',\n}\n\nsession.get\\(''https://shop.amul.com/en/browse/protein'', headers=headers, timeout=30\\)\nresp = session.get\\(f''https://shop.amul.com/user/info.js?_v={int\\(time.time\\(\\)*1000\\)}'', headers=headers, timeout=30\\)\nsession_data = json.loads\\(resp.text.replace\\(''session = '', ''''\\)\\)\nsession_tid = session_data.get\\(''tid'', ''''\\)\n\ndef generate_tid\\(\\):\n    timestamp = str\\(int\\(time.time\\(\\) * 1000\\)\\)\n    rand = random.randint\\(0, 999\\)\n    hash_input = f''{STORE_ID}:{timestamp}:{rand}:{session_tid}''\n    hash_value = hashlib.sha256\\(hash_input.encode\\(\\)\\).hexdigest\\(\\)\n    return f''{timestamp}:{rand}:{hash_value}''\n\napi_headers = {\n    **headers,\n    ''tid'': generate_tid\\(\\),\n    ''Accept'': ''application/json, text/plain, */*'',\n    ''Origin'': ''https://shop.amul.com'',\n    ''Referer'': ''https://shop.amul.com/en/browse/protein'',\n    ''frontend'': ''1'',\n}\n\n# Set pincode first\npref_url = ''https://shop.amul.com/entity/ms.settings/_/setPreferences''\npref_headers = {**api_headers, ''Content-Type'': ''application/json'', ''tid'': generate_tid\\(\\)}\nsession.put\\(pref_url, json={''pincode'': ''400063'', ''substore'': ''mumbai-br''}, headers=pref_headers, timeout=30\\)\n\n# Test 1: With substore ID instead of alias\nurl = ''https://shop.amul.com/api/1/entity/ms.products''\n\nparams1 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''filters[0][field]'': ''categories'',\n    ''filters[0][value]'': ''protein'',\n    ''filters[0][operator]'': ''in'',\n    ''substore'': ''66506000c8f2d6e221b9193a'',  # Using _id\n    ''limit'': 10\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params1, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nprint\\(f''With substore _id: {len\\(data.get\\(\"\"data\"\", []\\)\\)} items''\\)\n\n# Test 2: Without substore at all\nparams2 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''filters[0][field]'': ''categories'',\n    ''filters[0][value]'': ''protein'',\n    ''filters[0][operator]'': ''in'',\n    ''limit'': 10\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params2, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nprint\\(f''Without substore: {len\\(data.get\\(\"\"data\"\", []\\)\\)} items, total: {data.get\\(\"\"paging\"\", {}\\).get\\(\"\"total\"\", 0\\)}''\\)\n\n# Test 3: Using ''eq'' instead of ''in''\nparams3 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''filters[0][field]'': ''categories'',\n    ''filters[0][value]'': ''protein'',\n    ''filters[0][operator]'': ''eq'',\n    ''limit'': 10\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params3, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nprint\\(f''With eq operator: {len\\(data.get\\(\"\"data\"\", []\\)\\)} items''\\)\n\n# Test 4: Search for protein in name\nparams4 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''fields[categories]'': 1,\n    ''search'': ''protein'',\n    ''limit'': 20\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params4, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nitems = data.get\\(''data'', []\\)\nprint\\(f''Search \"\"protein\"\": {len\\(items\\)} items''\\)\nfor p in items[:5]:\n    print\\(f''  - {p.get\\(\"\"name\"\"\\)}: {p.get\\(\"\"categories\"\"\\)}''\\)\n\")",
      "Bash(python -c \"\n# -*- coding: utf-8 -*-\nimport requests\nimport hashlib\nimport time\nimport random\nimport json\nimport sys\nsys.stdout.reconfigure\\(encoding=''utf-8''\\)\n\nsession = requests.Session\\(\\)\nSTORE_ID = ''62fa94df8c13af2e242eba16''\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36 \\(KHTML, like Gecko\\) Chrome/120.0.0.0 Safari/537.36'',\n}\n\nsession.get\\(''https://shop.amul.com/en/browse/protein'', headers=headers, timeout=30\\)\nresp = session.get\\(f''https://shop.amul.com/user/info.js?_v={int\\(time.time\\(\\)*1000\\)}'', headers=headers, timeout=30\\)\nsession_data = json.loads\\(resp.text.replace\\(''session = '', ''''\\)\\)\nsession_tid = session_data.get\\(''tid'', ''''\\)\n\ndef generate_tid\\(\\):\n    timestamp = str\\(int\\(time.time\\(\\) * 1000\\)\\)\n    rand = random.randint\\(0, 999\\)\n    hash_input = f''{STORE_ID}:{timestamp}:{rand}:{session_tid}''\n    hash_value = hashlib.sha256\\(hash_input.encode\\(\\)\\).hexdigest\\(\\)\n    return f''{timestamp}:{rand}:{hash_value}''\n\napi_headers = {\n    **headers,\n    ''tid'': generate_tid\\(\\),\n    ''Accept'': ''application/json, text/plain, */*'',\n    ''Origin'': ''https://shop.amul.com'',\n    ''Referer'': ''https://shop.amul.com/en/browse/protein'',\n    ''frontend'': ''1'',\n}\n\n# Set pincode first\npref_url = ''https://shop.amul.com/entity/ms.settings/_/setPreferences''\npref_headers = {**api_headers, ''Content-Type'': ''application/json'', ''tid'': generate_tid\\(\\)}\nresp = session.put\\(pref_url, json={''pincode'': ''400063'', ''substore'': ''mumbai-br''}, headers=pref_headers, timeout=30\\)\nprint\\(f''Set preferences response: {resp.text[:500]}''\\)\n\n# Get all products without any filters\nurl = ''https://shop.amul.com/api/1/entity/ms.products''\nparams = {\n    ''limit'': 100\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nitems = data.get\\(''data'', []\\)\nprint\\(f''\\\\nAll products: {len\\(items\\)} items, total: {data.get\\(\"\"paging\"\", {}\\).get\\(\"\"total\"\", 0\\)}''\\)\n\n# Print all unique categories found\nall_cats = set\\(\\)\nfor p in items:\n    cats = p.get\\(''categories'', []\\)\n    if cats:\n        for c in cats:\n            all_cats.add\\(c\\)\n\nprint\\(f''\\\\nCategories in products: {all_cats}''\\)\n\n# Print some products\nprint\\(''\\\\nSample products:''\\)\nfor p in items[:10]:\n    name = p.get\\(''name'', ''N/A''\\)[:40]\n    cats = p.get\\(''categories'', []\\)\n    print\\(f''  - {name} | categories: {cats}''\\)\n\")",
      "Bash(python -c \"\n# -*- coding: utf-8 -*-\nimport requests\nimport hashlib\nimport time\nimport random\nimport json\nimport sys\nsys.stdout.reconfigure\\(encoding=''utf-8''\\)\n\n# Substore mapping from amul-notify project\nSUBSTORES = {\n    ''mumbai-br'': ''66506000c8f2d6e221b9193a'',\n    ''pune-br'': ''66506004a7cddee1b8adb014'',\n    ''delhi'': ''66505ff5145c16635e6cc74d'',\n    ''gujarat'': ''66505ff06510ee3d5903fd42'',\n    ''karnataka'': ''66505ff0998183e1b1935c75'',\n    ''telangana'': ''66506004aa64743ceefbed25'',\n}\n\nsession = requests.Session\\(\\)\nSTORE_ID = ''62fa94df8c13af2e242eba16''\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36 \\(KHTML, like Gecko\\) Chrome/120.0.0.0 Safari/537.36'',\n}\n\nsession.get\\(''https://shop.amul.com/en/browse/protein'', headers=headers, timeout=30\\)\nresp = session.get\\(f''https://shop.amul.com/user/info.js?_v={int\\(time.time\\(\\)*1000\\)}'', headers=headers, timeout=30\\)\nsession_data = json.loads\\(resp.text.replace\\(''session = '', ''''\\)\\)\nsession_tid = session_data.get\\(''tid'', ''''\\)\n\ndef generate_tid\\(\\):\n    timestamp = str\\(int\\(time.time\\(\\) * 1000\\)\\)\n    rand = random.randint\\(0, 999\\)\n    hash_input = f''{STORE_ID}:{timestamp}:{rand}:{session_tid}''\n    hash_value = hashlib.sha256\\(hash_input.encode\\(\\)\\).hexdigest\\(\\)\n    return f''{timestamp}:{rand}:{hash_value}''\n\napi_headers = {\n    **headers,\n    ''tid'': generate_tid\\(\\),\n    ''Accept'': ''application/json, text/plain, */*'',\n    ''Origin'': ''https://shop.amul.com'',\n    ''Referer'': ''https://shop.amul.com/en/browse/protein'',\n    ''frontend'': ''1'',\n}\n\n# Set pincode first\npref_url = ''https://shop.amul.com/entity/ms.settings/_/setPreferences''\npref_headers = {**api_headers, ''Content-Type'': ''application/json'', ''tid'': generate_tid\\(\\)}\nsession.put\\(pref_url, json={''pincode'': ''400063'', ''substore'': ''mumbai-br''}, headers=pref_headers, timeout=30\\)\n\n# Get products using ACTUAL _id\nurl = ''https://shop.amul.com/api/1/entity/ms.products''\nsubstore_id = SUBSTORES[''mumbai-br'']\nprint\\(f''Using substore _id: {substore_id}''\\)\n\nparams = {\n    ''fields[name]'': 1,\n    ''fields[sku]'': 1,\n    ''fields[price]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''fields[images]'': 1,\n    ''fields[alias]'': 1,\n    ''filters[0][field]'': ''categories'',\n    ''filters[0][value]'': ''protein'',\n    ''filters[0][operator]'': ''in'',\n    ''substore'': substore_id,\n    ''limit'': 50,\n    ''facets'': ''true''\n}\n\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params, headers=api_headers, timeout=30\\)\nprint\\(f''Status: {resp.status_code}''\\)\ndata = resp.json\\(\\)\nitems = data.get\\(''data'', []\\)\nprint\\(f''Products: {len\\(items\\)}, total: {data.get\\(\"\"paging\"\", {}\\).get\\(\"\"total\"\", 0\\)}''\\)\n\nif items:\n    for p in items[:5]:\n        name = p.get\\(''name'', ''N/A''\\)\n        qty = p.get\\(''inventory_quantity'', 0\\)\n        price = p.get\\(''price'', 0\\)\n        print\\(f''  - {name}: Rs.{price}, Qty: {qty}''\\)\nelse:\n    print\\(f''Full response: {json.dumps\\(data, indent=2\\)[:1000]}''\\)\n\")",
      "Bash(python -c \"\n# -*- coding: utf-8 -*-\nimport requests\nimport hashlib\nimport time\nimport random\nimport json\nimport sys\nsys.stdout.reconfigure\\(encoding=''utf-8''\\)\n\nsession = requests.Session\\(\\)\nSTORE_ID = ''62fa94df8c13af2e242eba16''\nMUMBAI_ID = ''66506000c8f2d6e221b9193a''\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36 \\(KHTML, like Gecko\\) Chrome/120.0.0.0 Safari/537.36'',\n}\n\nsession.get\\(''https://shop.amul.com/en/browse/protein'', headers=headers, timeout=30\\)\nresp = session.get\\(f''https://shop.amul.com/user/info.js?_v={int\\(time.time\\(\\)*1000\\)}'', headers=headers, timeout=30\\)\nsession_data = json.loads\\(resp.text.replace\\(''session = '', ''''\\)\\)\nsession_tid = session_data.get\\(''tid'', ''''\\)\n\ndef generate_tid\\(\\):\n    timestamp = str\\(int\\(time.time\\(\\) * 1000\\)\\)\n    rand = random.randint\\(0, 999\\)\n    hash_input = f''{STORE_ID}:{timestamp}:{rand}:{session_tid}''\n    hash_value = hashlib.sha256\\(hash_input.encode\\(\\)\\).hexdigest\\(\\)\n    return f''{timestamp}:{rand}:{hash_value}''\n\napi_headers = {\n    **headers,\n    ''tid'': generate_tid\\(\\),\n    ''Accept'': ''application/json, text/plain, */*'',\n    ''Origin'': ''https://shop.amul.com'',\n    ''Referer'': ''https://shop.amul.com/en/browse/protein'',\n    ''frontend'': ''1'',\n}\n\n# Test 1: No category filter, just substore\nurl = ''https://shop.amul.com/api/1/entity/ms.products''\nprint\\(''Test 1: Only substore filter''\\)\nparams1 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''substore'': MUMBAI_ID,\n    ''limit'': 20\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params1, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nprint\\(f''  Products: {len\\(data.get\\(\"\"data\"\", []\\)\\)}, total: {data.get\\(\"\"paging\"\", {}\\).get\\(\"\"total\"\", 0\\)}''\\)\n\n# Test 2: No filters at all\nprint\\(''\\\\nTest 2: No filters''\\)\nparams2 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''fields[categories]'': 1,\n    ''limit'': 20\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params2, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nitems = data.get\\(''data'', []\\)\nprint\\(f''  Products: {len\\(items\\)}, total: {data.get\\(\"\"paging\"\", {}\\).get\\(\"\"total\"\", 0\\)}''\\)\nif items:\n    print\\(''  Sample products:''\\)\n    for p in items[:3]:\n        print\\(f''    - {p.get\\(\"\"name\"\"\\)}: categories={p.get\\(\"\"categories\"\"\\)}''\\)\n\n# Test 3: Try ''collections'' filter for protein\nprint\\(''\\\\nTest 3: Using collections filter''\\)\nparams3 = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''filters[0][field]'': ''collections'',\n    ''filters[0][value]'': ''protein'',\n    ''filters[0][operator]'': ''in'',\n    ''substore'': MUMBAI_ID,\n    ''limit'': 20\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params3, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nprint\\(f''  Products: {len\\(data.get\\(\"\"data\"\", []\\)\\)}, total: {data.get\\(\"\"paging\"\", {}\\).get\\(\"\"total\"\", 0\\)}''\\)\n\")",
      "Bash(python -c \"\n# -*- coding: utf-8 -*-\nimport requests\nimport hashlib\nimport time\nimport random\nimport json\nimport sys\nsys.stdout.reconfigure\\(encoding=''utf-8''\\)\n\nsession = requests.Session\\(\\)\nSTORE_ID = ''62fa94df8c13af2e242eba16''\n\nSUBSTORES = {\n    ''mumbai-br'': ''66506000c8f2d6e221b9193a'',\n    ''delhi'': ''66505ff5145c16635e6cc74d'',\n    ''gujarat'': ''66505ff06510ee3d5903fd42'',\n    ''karnataka'': ''66505ff0998183e1b1935c75'',\n}\n\nheaders = {\n    ''User-Agent'': ''Mozilla/5.0 \\(Windows NT 10.0; Win64; x64\\) AppleWebKit/537.36 \\(KHTML, like Gecko\\) Chrome/120.0.0.0 Safari/537.36'',\n}\n\nsession.get\\(''https://shop.amul.com/en/browse/protein'', headers=headers, timeout=30\\)\nresp = session.get\\(f''https://shop.amul.com/user/info.js?_v={int\\(time.time\\(\\)*1000\\)}'', headers=headers, timeout=30\\)\nsession_data = json.loads\\(resp.text.replace\\(''session = '', ''''\\)\\)\nsession_tid = session_data.get\\(''tid'', ''''\\)\n\ndef generate_tid\\(\\):\n    timestamp = str\\(int\\(time.time\\(\\) * 1000\\)\\)\n    rand = random.randint\\(0, 999\\)\n    hash_input = f''{STORE_ID}:{timestamp}:{rand}:{session_tid}''\n    hash_value = hashlib.sha256\\(hash_input.encode\\(\\)\\).hexdigest\\(\\)\n    return f''{timestamp}:{rand}:{hash_value}''\n\napi_headers = {\n    **headers,\n    ''tid'': generate_tid\\(\\),\n    ''Accept'': ''application/json, text/plain, */*'',\n    ''Origin'': ''https://shop.amul.com'',\n    ''Referer'': ''https://shop.amul.com/en/browse/protein'',\n    ''frontend'': ''1'',\n}\n\nurl = ''https://shop.amul.com/api/1/entity/ms.products''\n\n# Test different substores for protein products\nprint\\(''Checking protein products across different substores:''\\)\nfor name, substore_id in SUBSTORES.items\\(\\):\n    params = {\n        ''fields[name]'': 1,\n        ''fields[inventory_quantity]'': 1,\n        ''filters[0][field]'': ''categories'',\n        ''filters[0][value]'': ''protein'',\n        ''filters[0][operator]'': ''in'',\n        ''substore'': substore_id,\n        ''limit'': 10\n    }\n    api_headers[''tid''] = generate_tid\\(\\)\n    resp = session.get\\(url, params=params, headers=api_headers, timeout=30\\)\n    data = resp.json\\(\\)\n    total = data.get\\(''paging'', {}\\).get\\(''total'', 0\\)\n    print\\(f''  {name}: {total} protein products''\\)\n\n# Also test without substore at all\nprint\\(''\\\\nWithout substore filter:''\\)\nparams = {\n    ''fields[name]'': 1,\n    ''fields[inventory_quantity]'': 1,\n    ''filters[0][field]'': ''categories'',\n    ''filters[0][value]'': ''protein'',\n    ''filters[0][operator]'': ''in'',\n    ''limit'': 10\n}\napi_headers[''tid''] = generate_tid\\(\\)\nresp = session.get\\(url, params=params, headers=api_headers, timeout=30\\)\ndata = resp.json\\(\\)\nitems = data.get\\(''data'', []\\)\ntotal = data.get\\(''paging'', {}\\).get\\(''total'', 0\\)\nprint\\(f''  Total: {total} protein products''\\)\nif items:\n    for p in items[:3]:\n        print\\(f''    - {p.get\\(\"\"name\"\"\\)}''\\)\n\")",
      "Bash(python:*)",
      "Bash(git push)",
      "Bash(python test_pincode.py:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(python test_set_pincode.py:*)"
    ]
  }
}
